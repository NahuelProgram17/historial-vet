{% extends 'base.html' %}

{% block title %}Historial de {{ object.pet_name }}{% endblock %}

{% block content %}
<div class="row justify-content-center">
    <div class="col-md-8">

        <div class="card shadow-sm">

            {% if object.image %}
            <div class="text-center my-3">
                <img src="{{ object.image.url }}"
                    alt="Imagen de {{ object.pet_name }}"
                    class="img-fluid rounded shadow-sm"
                    style="max-width: 420px; max-height: 420px; object-fit: cover;">
            </div>
            {% endif %}

            <div class="card-body">

                <!-- Nombre + especie -->
                <h2 class="card-title mb-2">üêæ {{ object.pet_name }}</h2>
                <p class="text-muted mb-2">
                üéÇ Edad: <strong>{{ object.age }} a√±os</strong></p>

                {% if object.species == 'perro' %}
                    <span class="badge bg-primary fs-6 mb-3">
                        {{ object.get_species_display }}
                    </span>
                {% elif object.species == 'gato' %}
                    <span class="badge bg-warning text-dark fs-6 mb-3">
                        {{ object.get_species_display }}
                    </span>
                {% else %}
                    <span class="badge bg-secondary fs-6 mb-3">
                        {{ object.get_species_display }}
                    </span>
                {% endif %}

                <hr>

                <!-- VACUNAS -->
                <div class="border rounded p-3 bg-light mb-4">
                    <h5 class="mb-3">üíâ Vacunas</h5>

                    <ul class="list-group">

                        {% if object.rabia %}
                        <li class="list-group-item d-flex justify-content-between align-items-center">
                            Vacuna contra la Rabia
                            <span class="badge bg-success">
                                {{ object.rabia_doses }} dosis
                            </span>
                        </li>
                        {% endif %}

                        {% if object.moquillo %}
                        <li class="list-group-item d-flex justify-content-between align-items-center">
                            Moquillo
                            <span class="badge bg-success">
                                {{ object.moquillo_doses }} dosis
                            </span>
                        </li>
                        {% endif %}

                        {% if object.parvovirus %}
                        <li class="list-group-item d-flex justify-content-between align-items-center">
                            Parvovirus
                            <span class="badge bg-success">
                                {{ object.parvovirus_doses }} dosis
                            </span>
                        </li>
                        {% endif %}

                        {% if not object.rabia and not object.moquillo and not object.parvovirus %}
                        <li class="list-group-item text-muted text-center">
                            No hay vacunas registradas
                        </li>
                        {% endif %}

                    </ul>
                </div>

                <!-- HISTORIAL CL√çNICO -->
                <h5 class="mb-2">ü©∫ Historial Cl√≠nico</h5>

                <div class="border rounded p-3 bg-light">
                    {{ object.clinical_history|safe }}
                </div>

                <p class="text-muted mt-3 mb-0">
                    üìÖ Creado el {{ object.created_at|date:"d/m/Y" }}
                </p>
            </div>

            <!-- FOOTER -->
            <div class="card-footer bg-white d-flex gap-2">
                <a href="{% url 'pages:list' %}" class="btn btn-outline-secondary w-50">
                    ‚Üê Volver
                </a>

                {% if user.is_authenticated and object.owner == user %}
                    <a href="{% url 'pages:update' object.pk %}" class="btn btn-warning w-25">
                        Editar
                    </a>
                    <a href="{% url 'pages:delete' object.pk %}" class="btn btn-danger w-25">
                        Eliminar
                    </a>
                {% endif %}
            </div>

        </div>
    </div>
</div>
{% endblock %}
